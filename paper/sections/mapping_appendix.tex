\section{General QUBO mapping}
In this section we describe a mapping to QUBO of a more general version of the deconflicting problem than that covered in the main text.

\subsection{Global trajectory modifications}
Consider the case in which each trajectory can be modified by a departure delay and some parameterized spatial transformation, i.e.\ for each flight $i$ there is a variable $d_i$ and some parameter $\boldsymbol \theta_i$.
For example, Rodionova et al.\ consider a single angle $\theta_i$ that determines a sinusoidal transformation of the trajectory.
To map to QUBO, we require that these variables be allowed to take on values from some finite set, so that are QUBO variables are $\{d_{i, \alpha}\}$ and $\{\boldsymbol \theta_{i,\phi}\}$, where $d_{i, \alpha} = 1$ ($d_{i, \alpha}$) indicates that $d_i = \alpha$ ($d_i \neq \alpha$) and similarly for $\boldsymbol \theta_{i, \phi}$.
For every pair of flights $i < j$, we can efficiently (in time and space polynomial in the size of the input) compute whether the corresponding trajectories conflict when modified according to $d_i$, $d_j$, $\boldsymbol \theta_i$ and $\boldsymbol \theta_j$.
Let $B_{i, j}$ be the set of values of $(d_i, \boldsymbol \theta_i, d_j, \boldsymbol \theta_j)$ such that the the modified trajectories conflict.
Lastly, let $d_{(i, \alpha), (j, \beta)}$ indicate that $d_i = \alpha$ and $ d_j = \beta$, and similarly for $\boldsymbol \theta_{(i, \phi), (j, \psi)}$.
The overall cost function is
\begin{equation}
\function{global}
\left(
{\left(d_{i,\alpha}\right)}_{i,\alpha}
{\left(d_{(i,\alpha),(j,\beta)}\right)}_{i,j,\alpha,\beta}
{\left(\boldsymbol \theta_{(i,\phi),(j,\psi)}\right)}_{i,j,\phi,\psi}
\right)
=
\function{encoding} +
\function{consistency} +
\function{delay} +
\function{conflict},
\end{equation}
where 
\begin{widetext}
\begin{equation}
  \function{encoding}
  =
  \weight{encoding}
  \left[
  \sum_{i} {\left(\sum_{\alpha} d_{i, \alpha} -1\right)}^2
  +
  \sum_{i} {\left(\sum_{\phi} \boldsymbol \theta_{i, \phi} -1\right)}^2
\right]
\end{equation}
ensures that the values of $d_i$ and $\boldsymbol \theta_i$ are uniquely encoded;
\begin{equation}
\function{consistency}
=
\weight{consistency}
\left[
\sum_{i < j,\alpha, \beta} 
s\left(d_{i,\alpha}, d_{j, \beta}, d_{(i, \alpha), (j, \beta)}\right)
+
\sum_{i < j,\phi, \psi} 
s\left(\boldsymbol \theta_{i,\phi}, \boldsymbol \theta_{j, \psi}, \boldsymbol \theta_{(i, \phi), (j, \psi)}\right)
\right]
\end{equation}
\end{widetext}
ensures consistency between the values of $d_{i,\alpha}$, $d_{j, \beta}$, and $d_{(i, \alpha), (j, \beta)}$;
\begin{equation}
s(x, y, z) = 3z + xy - 2xz - 2 yz
\end{equation}
is a non-negative penalty function that is zero if and only if $z = xy$;
\begin{equation}
\function{delay}
= \sum_{i, \alpha} \alpha d_{i, \alpha}
\end{equation}
is the cost function to be minimized; and
\begin{equation}
  \function{conflict}
=
\weight{conflict}
\sum_{i < j} 
\sum_{(\alpha, \phi, \beta, \psi) \in B_{i, j}} 
d_{(i, \alpha), (j, \beta)} \boldsymbol \theta_{(i, \phi), (j, \psi)}
\end{equation}
penalize conflicts.

\subsection{Local trajectory modifications}

Alternatively, we can consider modifications to the trajectory only near conflicts.
We describe a few special models and their mapping to QUBO,
though many more such ways of doing so, and we leave a full accounting for future work.

\subsubsection{Exclusive avoidance}
Suppose for every conflict $k$ and associated pair of flights $i < j$, there is a way for either flight to go around the trajectory of the other, introducing some delay $d_{i,k}$ to flight $i$ or $d_{j, k}$ to flight $j$ depending on which trajectory is changed.
Let $a_k = a_{i, k} = 1$ ($a_{i, k} = 0$) indicate that flight $i$'s trajectory is changed, and for convenience let $a_{j, k} = a_{i, k} - 1$, though only one (qu)bit will be used per conflict. % chktex 36
Adding in the departure delay, we have the total cost function
\begin{equation}
\function{exclusive}
=
\function{delay} +
\function{encoding},
\end{equation}
where 
\begin{equation}
\label{eq:delay-exclusive}
\function{delay} = 
\sum_{i}
\left[
\sum_{\alpha} \alpha d_{i, \alpha}
+
\sum_{k \in K_i} d_{i, k} a_{i, k}
\right]
\end{equation}
and
$\function{encoding}$ is as in~\eqref{eq:dep-delay-encoding-penalty}.
This assumes that the trajectory modifications don't introduce potential conflicts with other flights; this assumption can be partially relaxed by adding penalty terms of the form $a_{i,k} a_{j,k'}$ or $d_{i,\alpha} a_{j, k}$ as appropriate.

\subsubsection{Flexible avoidance}
Exclusive \emph{requires} that one or the other flight is delayed at each conflict.
We can relax this by accounting for the fact that if the flights arriving at a potential conflict are already relatively delayed, the conflict could be passively avoided.
Let $D_{k, \gamma} = 1$ ($D_{k, \gamma} = 0$) indicate that $D_k = \gamma$ ($D_k \neq \gamma$), where $D_k$ is the difference in the accumulated delays at conflict $k$ as defined in~\eqref{eq:accum-delay-diff}.

\begin{equation}
\function{flexible}
=
\function{encoding} +
\function{delay} +
\function{consistency} + 
\function{conflict}
\end{equation}
\begin{equation}
\function{encoding}
=
\weight{encoding}
\left[
  \sum_i {\left(\sum_{\alpha} d_{i, \alpha} - 1\right)}^2
  +
  \sum_{k}
  {\left(\sum_{\gamma} D_{k, \gamma} - 1\right)}^2
\right]
\end{equation}

\begin{equation}
D_{i, k} = \sum_{\alpha} \alpha d_{i, \alpha} +
\sum_{\left. k' \in K_i \middle| k' < k\right.}
d_{i, k'} a_{i, k'}
\end{equation}

\begin{equation}
\function{consistency}
=
\sum_k
{\left( 
D_{i, k} - D_{j, k}
-
\sum_{\gamma} \gamma D_{k, \gamma}
\right)}^2
\end{equation}
and $\function{delay}$ as in~\eqref{eq:delay-exclusive} but where $a_{i,k}$ and $a_{j, k}$ are separate bits.
\begin{equation}
\function{conflict}
=
\weight{conflict}
\sum_k \sum_{\gamma \in B_k} 
\left[
D_{k, \gamma}
\left(1 - a_{i, k} - a_{j, k}\right)
+ 2 a_{i, k} a_{j, k}
\right]
\end{equation}

If we want to allow both flights to be delayed at conflict $a_{i,k} = a_{j, k} = 1$, we must introduce an ancillary bit $a_k$ that indicates whether at least one flight is delayed at conflict $k$, adding
\begin{equation}
  \weight{consistency}
  \sum_{k} 
  \left[
    \left(a_{i, k} + a_{j, k} \right) \left(1 - 2 a_k\right)
    + a_{i, k} a_{j, k}
  \right]
\end{equation}
to $\function{consistency}$, and
replacing $\function{conflict}$ with
\begin{equation}
\sum_k \sum_{\gamma \in B_k} D_{k, \gamma} (1 - a_k).
\end{equation}

\subsubsection{Interstitial delays}

