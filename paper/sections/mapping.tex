\section{Mapping to QUBO}

\subsection{Departure delays}
\label{sec:departure_delay_model}
In this section we describe a simplified version of the above problem.
We restrict ourselves to departure delays and neglect maneuvers.
Hence the optimization problem can be written as
\begin{align}
    & \min_{d_i} \sum_i d_i \notag \\
    & \text{s.t.}  \quad 
    d_i - d_j \notin D_k \qquad \forall \, (t, t') \in T_k \label{eqn:departure_delay_model}
\end{align}

The problem needs to be mapped to a quadratic binary optimization problem (QUBO) in order to be solvable by a D-Wave quantum annealer.
As a first step, we introduce a discretization and upper bound for the departure delay variables 
\begin{equation*}
    d_i \in \{0, \Delta_d, 2\Delta_d, \dots, d_\text{max} \}\, ,
\end{equation*}
where $d_\text{max} = N_d \Delta_d$ and $(N_d + 1)$ is the number of delay steps.
With this we can write the departure delay variables in terms of new binary variables $d_{i\alpha}$ by
\begin{align}
    d_i & = \sum_\alpha \alpha d_{i\alpha} \notag \\
    \alpha & \in \{0, \Delta_d, 2\Delta_d, \dots, d_\text{max} \}\, . \label{eqn:departure_delay_model_discretization}
\end{align}
However, this approach requires $\sum_\alpha d_{i\alpha} = 1$ to have a unique representation of $d_i$ by $d_{i\alpha}$.
This is achieved by adding the following contribution to the QUBO
\begin{equation}
    \label{eqn:departure_delay_model_qubo_unique}
    Q_\text{unique} = \lambda_\text{unique} \sum_i \left( \sum_\alpha d_{i\alpha} - 1 \right)^2 \; .
\end{equation}
where $\lambda_\text{unique}$ is a penalty weight sufficiently large to ensure $Q_\text{unique}=0$ for the solution.
The cost function in \eqref{eqn:departure_delay_model} yields contribution
\begin{equation}
    \label{eqn:departure_delay_model_qubo_departure}
    Q_\text{delay} = \frac{1}{d_\text{max}}\sum_{i\alpha} \alpha d_{i\alpha} \; ,
\end{equation}
where we have chosen the prefactor $1/d_\text{max}$ for convenience.
The last contribution to the QUBO represents the conflict avoidance
\begin{equation}
    \label{eqn:departure_delay_model_qubo_conflict}
    Q_\text{conflict} = \lambda_\text{conflict} \sum_k \sum_{(\alpha, \beta) \in A_k} d_{i\alpha} d_{j\alpha} \biggl. \biggr|_{i, j \in I_k}
\end{equation}
where $A_k$ is the set of all $(\alpha, \beta)$ which correspond to a conflict
\begin{equation*}
    A_k = \{(\alpha, \beta) \; | \; \alpha - \beta \in D_k\}
\end{equation*}
Again, $\lambda_\text{conflict}$ is the penalty weight for this contribution which have to be chosen large enough to ensure $Q_\text{conflict}=0$ for the solution.
The total QUBO of the departure delay model then reads
\begin{equation*}
    Q_\text{DDM} = Q_\text{delay} + Q_\text{unique} + Q_\text{conflict}
\end{equation*}

\input{sections/maneuvers.tex}
